{"version":3,"sources":["../../src/class/invoice.ts"],"sourcesContent":["import fs from \"fs\";\r\nimport pdfkit from \"pdfkit\";\r\nimport type {\r\n\tCompany,\r\n\tCustomer,\r\n\tInvoice,\r\n\tInvoicePayLoad,\r\n\tSimplePDFInvoice,\r\n} from \"../../types/index.js\";\r\n\r\n/**\r\n * Main class that creates a PDF invoice.\r\n *\r\n * @since 1.0.0\r\n */\r\nexport class PDFInvoice implements SimplePDFInvoice {\r\n\tpayload: InvoicePayLoad;\r\n\tcompany: Company;\r\n\tinvoice: Invoice;\r\n\tcustomer: Customer;\r\n\titems: any;\r\n\tpath: string;\r\n\tdate: string;\r\n\t//config: Configurations;\r\n\tdoc: PDFKit.PDFDocument;\r\n\tmaxWidth: number;\r\n\tmaxHeight: number;\r\n\tconstructor(payload: InvoicePayLoad) {\r\n\t\tthis.payload = payload;\r\n\t\tthis.company = this.payload.company; // Company information\r\n\t\tthis.invoice = this.payload.invoice; // Invoice information\r\n\t\tthis.customer = this.payload.customer; // Customer information\r\n\t\tthis.items = this.payload.items; // Items information\r\n\t\tthis.path = this.payload.path; // Invoice path where to save.\r\n\t\tthis.date = new Date().toLocaleDateString(\"en-US\", {\r\n\t\t\tyear: \"numeric\",\r\n\t\t\tmonth: \"numeric\",\r\n\t\t\tday: \"numeric\",\r\n\t\t});\r\n\r\n\t\t// Configurations\r\n\t\t//this.config = config;\r\n\r\n\t\t// Create a document\r\n\t\tthis.doc = new pdfkit({ size: \"A4\", margin: 40 });\r\n\r\n\t\t// Height & width\r\n\t\tthis.maxWidth =\r\n\t\t\tthis.doc.page.width -\r\n\t\t\t(this.doc.page.margins.left + this.doc.page.margins.right);\r\n\t\tthis.maxHeight =\r\n\t\t\tthis.doc.page.height -\r\n\t\t\t(this.doc.page.margins.top + this.doc.page.margins.bottom);\r\n\t}\r\n\r\n\t/**\r\n\t * Render company information.\r\n\t *\r\n\t * @returns {void}\r\n\t * @since 1.0.0\r\n\t */\r\n\trenderHeader(): void {\r\n\t\tif (!this.company || typeof this.company !== \"object\") {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Company information must be an object. Check doc.\"\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst { name, logo, address, phone, email, website } = this.company;\r\n\r\n\t\tif (!name) {\r\n\t\t\tthrow new Error(\"Company name is required.\");\r\n\t\t}\r\n\r\n\t\tconst commonStyles = {\r\n\t\t\twidth: 180,\r\n\t\t\tlineGap: 1,\r\n\t\t\tlineBreak: true,\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Left side of the invoice.\r\n\t\t */\r\n\r\n\t\t// Company name\r\n\t\tthis.doc\r\n\t\t\t.fontSize(20)\r\n\t\t\t.font(\"Helvetica-Bold\")\r\n\t\t\t.fillColor(\"#000000\")\r\n\t\t\t.text(name, 40, 40, { ...commonStyles, align: \"left\" })\r\n\t\t\t.moveDown();\r\n\r\n\t\t// Address & contact information.\r\n\t\tif (address) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(address, 40, 70, { ...commonStyles, align: \"left\" })\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\r\n\t\t// Phone\r\n\t\tif (phone) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(phone, { ...commonStyles, align: \"left\" })\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\r\n\t\t// Email\r\n\t\tif (email) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(email, { ...commonStyles, align: \"left\" })\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\r\n\t\t// Website\r\n\t\tif (website) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(website, { ...commonStyles, align: \"left\" })\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Right side of the invoice.\r\n\t\t */\r\n\t\tconst { number, date, dueDate, status } = this.invoice;\r\n\r\n\t\tthis.doc\r\n\t\t\t.fontSize(20)\r\n\t\t\t.font(\"Helvetica\")\r\n\t\t\t.fillColor(\"#000000\")\r\n\t\t\t.text(\"I N V O I C E\", 430, 40, {\r\n\t\t\t\t...commonStyles,\r\n\t\t\t\talign: \"left\",\r\n\t\t\t\twidth: 150,\r\n\t\t\t})\r\n\t\t\t.moveDown(1);\r\n\r\n\t\t// Invoice number\r\n\t\tthis.doc\r\n\t\t\t.fontSize(10)\r\n\t\t\t.font(\"Helvetica-Bold\")\r\n\t\t\t.fillColor(\"#333333\")\r\n\t\t\t.text(`Ref: #${this.invoice.number || 1}`, 430, 70, {\r\n\t\t\t\t...commonStyles,\r\n\t\t\t\talign: \"left\",\r\n\t\t\t\twidth: 150,\r\n\t\t\t})\r\n\t\t\t.moveDown(0.5);\r\n\r\n\t\tthis.doc\r\n\t\t\t.fontSize(10)\r\n\t\t\t.font(\"Helvetica\")\r\n\t\t\t.fillColor(\"#333333\")\r\n\t\t\t.text(`Date: ${this.invoice.date || this.date}`, {\r\n\t\t\t\t...commonStyles,\r\n\t\t\t\talign: \"left\",\r\n\t\t\t\twidth: 150,\r\n\t\t\t})\r\n\t\t\t.moveDown(0.5);\r\n\r\n\t\tthis.doc\r\n\t\t\t.fontSize(10)\r\n\t\t\t.font(\"Helvetica\")\r\n\t\t\t.fillColor(\"#333333\")\r\n\t\t\t.text(`Due Date: ${this.invoice.dueDate || this.date}`, {\r\n\t\t\t\t...commonStyles,\r\n\t\t\t\talign: \"left\",\r\n\t\t\t\twidth: 150,\r\n\t\t\t})\r\n\t\t\t.moveDown(0.5);\r\n\r\n\t\tif (status) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica-Bold\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(`Status: ${this.invoice.status}`, {\r\n\t\t\t\t\t...commonStyles,\r\n\t\t\t\t\talign: \"left\",\r\n\t\t\t\t\twidth: 150,\r\n\t\t\t\t})\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Render customer information.\r\n\t *\r\n\t * @returns {void}\r\n\t * @since 1.0.0\r\n\t */\r\n\trenderCustomer(): void {\r\n\t\tif (!this.customer || typeof this.customer !== \"object\") {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t\"Customer information must be an object. Check doc.\"\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tconst { name, address, phone, email } = this.customer;\r\n\r\n\t\tif (!name) {\r\n\t\t\tthrow new Error(\"Customer name is required.\");\r\n\t\t}\r\n\r\n\t\tconst commonStyle = {\r\n\t\t\twidth: 180,\r\n\t\t\tlineGap: 1,\r\n\t\t\tlineBreak: true,\r\n\t\t};\r\n\r\n\t\tthis.doc\r\n\t\t\t.fontSize(14)\r\n\t\t\t.font(\"Helvetica-Bold\")\r\n\t\t\t.fillColor(\"#000000\")\r\n\t\t\t.text(\"Bill To: \", 40, 180)\r\n\t\t\t.moveDown(0.5);\r\n\r\n\t\t// Customer name\r\n\t\tthis.doc\r\n\t\t\t.fontSize(10)\r\n\t\t\t.font(\"Helvetica-Bold\")\r\n\t\t\t.fillColor(\"#333333\")\r\n\t\t\t.text(name, { ...commonStyle, align: \"left\" })\r\n\t\t\t.moveDown(0.5);\r\n\r\n\t\t// Address\r\n\t\tif (address) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(address, { ...commonStyle, align: \"left\" })\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\r\n\t\t// Phone\r\n\t\tif (phone) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(phone, { ...commonStyle, align: \"left\" })\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\r\n\t\t// Email\r\n\t\tif (email) {\r\n\t\t\tthis.doc\r\n\t\t\t\t.fontSize(10)\r\n\t\t\t\t.font(\"Helvetica\")\r\n\t\t\t\t.fillColor(\"#333333\")\r\n\t\t\t\t.text(email, { ...commonStyle, align: \"left\" })\r\n\t\t\t\t.moveDown(0.5);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Render items.\r\n\t *\r\n\t * @returns {void}\r\n\t * @since 1.0.0\r\n\t */\r\n\trenderItems(): void {\r\n\t\tif (!this.items || !Array.isArray(this.items)) {\r\n\t\t\tthrow new Error(\"Items must be an array. Check doc.\");\r\n\t\t}\r\n\r\n\t\tconst tableHeaders = [\"Item\", \"Qty\", \"Price\", \"Total\"];\r\n\r\n\t\tconst table = {\r\n\t\t\theaders: tableHeaders,\r\n\t\t\toptions: {\r\n\t\t\t\tx: 40,\r\n\t\t\t\ty: 300,\r\n\t\t\t\twidth: this.maxWidth,\r\n\t\t\t\tcolumnWidths: [200, 100, 100, 115],\r\n\t\t\t\theaderBackground: \"#000000\",\r\n\t\t\t\theaderColor: \"#FFFFFF\",\r\n\t\t\t\theaderRadius: 3,\r\n\t\t\t},\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Render the table header row.\r\n\t\t */\r\n\t\tthis.doc.fillColor(table.options.headerColor);\r\n\t\tthis.doc\r\n\t\t\t.roundedRect(\r\n\t\t\t\ttable.options.x,\r\n\t\t\t\ttable.options.y,\r\n\t\t\t\ttable.options.width,\r\n\t\t\t\t25,\r\n\t\t\t\ttable.options.headerRadius\r\n\t\t\t)\r\n\t\t\t.fill(table.options.headerBackground);\r\n\r\n\t\tthis.doc\r\n\t\t\t.font(\"Helvetica\")\r\n\t\t\t.fontSize(10)\r\n\t\t\t.fillColor(table.options.headerColor);\r\n\r\n\t\tlet startX = table.options.x;\r\n\r\n\t\ttable.headers.forEach((label, index) => {\r\n\t\t\t// Adjust text position within the header cell\r\n\t\t\tthis.doc.text(label, startX + 10, table.options.y + 9);\r\n\t\t\tstartX += table.options.columnWidths[index];\r\n\t\t});\r\n\r\n\t\tlet rowY = table.options.y + 40;\r\n\r\n\t\tlet totalCost = 0;\r\n\r\n\t\t/**\r\n\t\t * Render the table items.\r\n\t\t */\r\n\t\tthis.doc.font(\"Helvetica\");\r\n\t\tthis.doc.fillColor(\"#333333\");\r\n\r\n\t\tthis.items.forEach((item) => {\r\n\t\t\tconst { name, quantity, price } = item;\r\n\t\t\tconst total = quantity * price;\r\n\r\n\t\t\ttotalCost += total;\r\n\r\n\t\t\tlet startX = table.options.x;\r\n\r\n\t\t\t[name, quantity, price, total].forEach(\r\n\t\t\t\t(label: string, index: number) => {\r\n\t\t\t\t\tthis.doc.text(label, startX + 10, rowY, {\r\n\t\t\t\t\t\twidth: table.options.columnWidths[index],\r\n\t\t\t\t\t});\r\n\t\t\t\t\tstartX += table.options.columnWidths[index];\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\t// Adjust items height as needed.\r\n\t\t\trowY += 25;\r\n\t\t});\r\n\r\n\t\t/**\r\n\t\t * Render line.\r\n\t\t */\r\n\t\tthis.renderLine(rowY);\r\n\r\n\t\t/**\r\n\t\t * Render subtotal, tax and total cost.\r\n\t\t */\r\n\t\trowY += 20;\r\n\r\n\t\tconst sectionPosition = this.maxWidth - 115;\r\n\r\n\t\tconst tax = 0;\r\n\t\tconst discount = 0;\r\n\r\n\t\tconst data: any = {\r\n\t\t\tSubtotal: \"$\" + totalCost,\r\n\t\t\tTax: \"$\" + (tax ? tax : \"0\"),\r\n\t\t\tDiscount: \"$\" + (discount ? discount : \"0\"),\r\n\t\t\tTotal: \"$\" + totalCost,\r\n\t\t};\r\n\r\n\t\tObject.keys(data).forEach((key, index) => {\r\n\t\t\tthis.doc.fillColor(\"#333333\");\r\n\t\t\tthis.doc.fontSize(10);\r\n\t\t\tthis.doc.text(key + \": \" + data[key], sectionPosition, rowY, {\r\n\t\t\t\talign: \"left\",\r\n\t\t\t\twidth: 200,\r\n\t\t\t\tlineGap: 2,\r\n\t\t\t});\r\n\r\n\t\t\trowY += 25;\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Render <hr> line.\r\n\t *\r\n\t * @returns {void}\r\n\t * @since 1.0.0\r\n\t */\r\n\trenderLine(y: number): void {\r\n\t\tthis.doc.lineWidth(1 / 72);\r\n\t\tthis.doc.strokeColor(\"#DDDDDD\");\r\n\r\n\t\t// Define the starting point of the line (x, y) and its ending point\r\n\t\tconst startX = this.doc.page.margins.left; // Starting from the left margin\r\n\t\tconst endX = this.doc.page.width - this.doc.page.margins.right; // Ending at the right margin\r\n\r\n\t\tthis.doc.moveTo(startX, y).lineTo(endX, y).stroke();\r\n\t}\r\n\r\n\t/**\r\n\t * Render footer.\r\n\t *\r\n\t * @returns {void}\r\n\t * @since 1.0.0\r\n\t */\r\n\trenderFooter(): void {}\r\n\r\n\t/**\r\n\t * Write invoice itself.\r\n\t *\r\n\t * @returns {Promise<boolean>} boolean.\r\n\t * @since 1.0.0\r\n\t */\r\n\tasync create(): Promise<string> {\r\n\t\tthis.renderHeader();\r\n\t\tthis.renderCustomer();\r\n\t\tthis.renderItems();\r\n\r\n\t\t/**\r\n\t\t * Start writing the invoice.\r\n\t\t */\r\n\t\tthis.doc.end();\r\n\r\n\t\t/**\r\n\t\t * Create a stream to write the invoice.\r\n\t\t */\r\n\t\tconst stream = this.doc.pipe(fs.createWriteStream(this.path));\r\n\r\n\t\t/**\r\n\t\t * Return a promise.\r\n\t\t */\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tstream.on(\"finish\", () => {\r\n\t\t\t\tresolve(this.path);\r\n\t\t\t});\r\n\t\t\tstream.on(\"error\", (error) => {\r\n\t\t\t\treject(error);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n"],"mappings":"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","names":["startX"]}